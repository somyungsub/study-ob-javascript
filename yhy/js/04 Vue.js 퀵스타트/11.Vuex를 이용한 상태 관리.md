# 11장 Vuex

## Vuex란
* Vue.js 애플리케이션에서 상태 관리 패턴을 지원하는 라이브러리
* 애플리케이션 내부의 모든 컴포넌트들이 공유하는 중앙집중화된 상태 정보 저장소 역할을 하며 상태 변경을 투명하게 할 수 있다.
* 각 컴포넌트가 공유하는 상태 데이터는 전역에서 관리한다.
* 부모에서 자식으로 또 그 자식으로 props를 이용해 속성을 계속해서 전달하지 않아도 되며, 상태 데이터를 변경하기 위해 부모 컴포넌트로 이벤트를 발생시키지 않아도 된다.
```javascript
// src/main.js
import Vue from 'vue'
import TodoList from './components/TodoList.vue'

new Vue({
  el: '#app',
  render: h => h(TodoList)
})
```
```javascript
// src/components/EventBus.vue
<script type="text/javascript">
import Vue from 'vue';
var eventBus = new Vue();
export default eventBus;
</script>
```
```javascript
// src/components/List.vue
<style>
...
</style>
<template>
    <ul id="todolist">
        <li v-for="(a, index) in todolist" v-bind:class="checked(a.done)"
            v-on:click="doneToggle(index)">
            <span>{{ a.todo }}</span>
            <span v-if="a.done"> (완료)</span>
            <span class="close" v-on:click.stop="deleteTodo(index)">&#x00D7;</span>
        </li>
    </ul>
</template>
<script type="text/javascript">
/*
import eventBus from './EventBus.vue'
export default {
    created : function() {
         eventBus.$on('add-todo', this.addTodo);
    },
    data : function() {
        return {
            todolist : [
                { todo : "영화보기", done:false },
                { todo : "주말 산책", done:true },
                { todo : "ES6 학습", done:false },
                { todo : "잠실 야구장", done:false },
            ]
        }
    },
    methods : {
        checked : function(done) {
            if(done) return { checked:true };
            else return { checked:false };
        },
        addTodo : function(todo) {
            if (todo !== "") {
                this.todolist.push({ todo : todo, done:false });
            }
        },
        doneToggle : function(index) {
            this.todolist[index].done = !this.todolist[index].done;
        },
        deleteTodo : function(index) {
            this.todolist.splice(index,1);
        }
    }
}
*/

import Constant from '../constant'
import { mapState, mapMutations } from 'vuex'
import _ from 'lodash';
export default {
    computed : mapState({
        todolist : (state)=> state.todolist
    }),
    methods : _.extend({
            checked : function(done) {
                if(done) return { checked:true };
                else return { checked:false };
            }
        },
        mapMutations({
            deleteTodo : Constant.DELETE_TODO ,
            doneToggle : Constant.DONE_TOGGLE
        })
    )
}
</script>
```
```javascript
// src/components/inputTodo.vue
<style>
...
</style>
<template>
    <div>
        <input class="input" type="text" id="task" v-model.trim="todo" 
            placeholder="입력 후 엔터!" v-on:keyup.enter="addTodo">
        <span class="addbutton" v-on:click="addTodo">추 가</span>
    </div>    
</template>
<script type="text/javascript">
// import eventBus from './EventBus.vue'
import Constant from '../constant'

export default {
    name : 'input-todo',
    data : function() {
        return { todo : "" }
    },
    methods : {
        addTodo : function() {
            // eventBus.$emit('add-todo', this.todo);
            this.$store.commit(Constant.ADD_TODO, { todo: this.todo });
            this.todo = "";
        }
    }
}
</script>
```
